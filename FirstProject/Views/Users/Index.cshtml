@using FirstProject.Models
@model IEnumerable<Person>
<h2>Users</h2>
<div class="row">
    <div class="col-md-4">
        <a class="btn btn-primary" href="@Url.Action("Create", "Users")" role="button">Create</a>
    </div>
    <div class="col-md-4 col-md-offset-4">
        <input id="SearchString" name="SearchString"  type="search"  aria-label="Search" class="form-control mr-sm-2" placeholder="Search" />
        @*<input class="btn btn-primary" type="button" value="Search" id="btnSearch" />*@
    </div>
</div>
<p></p>
<div id="Listing">
    @Html.Partial("Listing", Model)

</div>
<div id="modDialog" class="modal fade">
    <div id="dialogContent" class="modal-dialog">

    </div>
</div>
@section scripts
{

    <script type="text/javascript">


        window.addEventListener("popstate", function (e) {
            $.ajax({
                url: location.href,
                success: function (result) {
                    $('#Listing').html(result);
                }
            });
        });

        function ChangeUrl(page, url) {
            if (typeof (history.pushState) != "undefined") {
                var obj = { Page: page, Url: url };
                history.pushState(null, obj.Page, obj.Url);
            } else {
                alert("Browser does not support HTML5.");
            }
        }

        function getUrlVars() {
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        function search() {
            $.ajax({
                url: "/Users/Index?searchString=" + $('#SearchString').val(),
                success: function (result) {
                    ChangeUrl("index", "/Users/Index?searchString=" + $('#SearchString').val());
                    $('#Listing').html(result);
                }
            });
        }

        $(function () {
            $("#btnSearch").click(function () {
                search();
            });

            $("#SearchString").keypress(function (e) {
                if (e.keyCode == 13) {
                    search();
                }
            });
        });

        $(function () {
            $.ajaxSetup({ cache: false });
            $(".CommentPopUp").click(function (e) {

                e.preventDefault();
                $.get(this.href, function (data) {
                    $('#dialogContent').html(data);
                    $('#modDialog').modal('show');
                });
            });
        })
        $(function () {
            $.ajaxSetup({ cache: false });
            $(".DeletePopUp").click(function (e) {

                e.preventDefault();
                $.get(this.href, function (data) {
                    $('#dialogContent').html(data);
                    $('#modDialog').modal('show');
                });
            });
        })

    </script>

}